<!DOCTYPE html>
<html>
<head><title>Dashboard Test</title></head>
<body>
<h2>Testing Live Data from API</h2>
<div id="results"></div>
<script>
async function testAPI() {
  const results = document.getElementById('results');
  try {
    const response = await fetch('https://saxtech-metrics-api.azurewebsites.net/api/metrics');
    const data = await response.json();
    
    let html = '<h3>Kubernetes Data:</h3>';
    if (data.kubernetes) {
      html += `<p>Cluster Count: ${data.kubernetes.clusterCount}</p>`;
      html += `<p>Total Nodes: ${data.kubernetes.totalNodes}</p>`;
      html += `<p>CPU Usage: ${data.kubernetes.avgCpuUsage}%</p>`;
      html += `<p>Memory Usage: ${data.kubernetes.avgMemoryUsage}%</p>`;
      if (data.kubernetes.clusters && data.kubernetes.clusters[0]) {
        html += `<p>Cluster Name: ${data.kubernetes.clusters[0].name}</p>`;
        html += `<p>Version: ${data.kubernetes.clusters[0].kubernetesVersion}</p>`;
      }
    } else {
      html += '<p>No Kubernetes data</p>';
    }
    
    html += '<h3>Resource Counts:</h3>';
    if (data.resources) {
      html += `<p>Static Sites: ${data.resources.staticSites}</p>`;
      html += `<p>Function Apps: ${data.resources.functionApps}</p>`;
      html += `<p>Storage Accounts: ${data.resources.storageAccounts}</p>`;
    }
    
    html += '<h3>Costs:</h3>';
    if (data.costs) {
      html += `<p>Month to Date: $${data.costs.monthToDate || 0}</p>`;
      html += `<p>Yesterday: $${data.costs.yesterday || 0}</p>`;
    } else {
      html += '<p>Cost data is null</p>';
    }
    
    html += '<h3>Backup Status:</h3>';
    if (data.backupStatus) {
      html += `<p>Status: ${data.backupStatus.summary.status}</p>`;
      html += `<p>Vaults: ${data.backupStatus.summary.totalVaults}</p>`;
    }
    
    results.innerHTML = html;
  } catch (error) {
    results.innerHTML = '<p>Error: ' + error.message + '</p>';
  }
}
testAPI();
</script>
</body>
</html>
